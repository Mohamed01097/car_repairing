<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_fleet_workorder_form" model="ir.ui.view">
            <field name="name">fleet.workorder.form</field>
            <field name="model">fleet.workorder</field>
            <field name="arch" type="xml">
                <form string="Work Orders" version="9.0">
                    <header colspan="8">
                        <button name="action_start_working" string="Start" type="object" invisible="state != 'draft'"
                                help="Start Working"
                                groups="car_repair_industry.group_fleet_repair_technician,car_repair_industry.group_fleet_repair_directeur_commercial"/>
                        <button name="button_cancel" string="Cancel Order" type="object"
                                invisible="state not in ['draft','startworking']" help="Cancel Order"
                                groups="car_repair_industry.group_fleet_repair_technician,car_repair_industry.group_fleet_repair_directeur_commercial"/>
                        <button name="button_draft" string="Set Draft" type="object" invisible="state != 'cancel'"
                                groups="car_repair_industry.group_fleet_repair_technician,car_repair_industry.group_fleet_repair_directeur_commercial"
                                help="Set to Draft"/>
                        <button name="button_resume" string="Resume" type="object" invisible="state != 'pause'"
                                help="Resume Work Order"
                                groups="car_repair_industry.group_fleet_repair_technician,car_repair_industry.group_fleet_repair_directeur_commercial"/>
                        <button name="button_pause" string="Pending" type="object" invisible="state != 'startworking'"
                                help="Pause Work Order"
                                groups="car_repair_industry.group_fleet_repair_technician,car_repair_industry.group_fleet_repair_directeur_commercial"/>
                        <button name="action_done" string="Finished" type="object" invisible="state != 'startworking'"
                                help="Finish Order"
                                groups="car_repair_industry.group_fleet_repair_technician,car_repair_industry.group_fleet_repair_directeur_commercial"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,startworking,done"/>
                    </header>
                    <sheet string="Work Orders">

                        <div class="oe_button_box" name="button_box">
                            <button type="object"
                                    name="button_view_repair"
                                    class="oe_stat_button"
                                    icon="fa-truck"
                                    invisible="count_fleet_repair == 0" groups="base.group_user">
                                <field name="count_fleet_repair" widget="statinfo" string="Repair Order"/>
                            </button>


                            <!--                            <button type="object"-->
                            <!--                                    name="button_view_diagnosis"-->
                            <!--                                    class="oe_stat_button"-->
                            <!--                                    icon="fa-pencil-square"-->
                            <!--                                    invisible="count_dig == 0" groups="base.group_user">-->
                            <!--                                <field name="count_dig" widget="statinfo" string="Diagnoses"/>-->
                            <!--                            </button>-->

                            <button type="object"
                                    name="button_view_saleorder"
                                    class="oe_stat_button"
                                    icon="fa-usd"
                                    invisible="saleorder_count == 0" groups="base.group_user">
                                <field name="saleorder_count" widget="statinfo" string="Sales Orders"/>
                            </button>
                        </div>

                        <div class="oe_title oe_left">
                            <h1>
                                <field name="sequence"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="name" readonly="True"/>
                                <field name="client_id" string="Client Name" readonly="True"/>
                                <field name="sale_order_id" invisible="True"/>
                                <field name="confirm_sale_order" invisible="True"/>
                            </group>
                            <group>
                                <field name="date" readonly="True"/>
                                <field name="priority" widget="priority" readonly="True" invisible="1"/>
                                <field name="fleet_repair_id" invisible="True"/>
                                <field name="diagnose_id" invisible="True"/>
                            </group>
                        </group>
                        <group string="Task Assignment">
                            <group>
                                <field name="responsible_person"/>
                                <field name="checklist_ids" widget="many2many_tags"/>
                            </group>
                            <group>
                                <field name="parking_slot"/>
                                <field name="car_lift"/>
                            </group>

                        </group>
                        <notebook>
                            <page string="Information">
                                <!--                                <group>-->
                                <!--                                    <group string="Planned Date">-->
                                <!--                                        <field name="date_planned"/>-->
                                <!--                                        <field name="date_planned_end"/>-->
                                <!--                                    </group>-->
                                <!--                                    <group string="Duration">-->
                                <!--                                        <field name="hour" widget="float_time"/>-->
                                <!--                                    </group>-->
                                <!--                                </group>-->
                                <group string="Actual Repairing Date">
                                    <group>
                                        <field name="date_start"/>
                                        <field name="date_finished"/>
                                    </group>
                                    <group>
                                        <field name="delay" widget="float_time" string="Total Duration"/>
                                        <field name="hours_worked" widget="float_time" string="Actual Duration"
                                               readonly="1"/>
                                    </group>
                                </group>
                                <separator string="fleet Info"/>
                                <field name="fleet_repair_line">
                                    <list>
                                        <field name="fleet_id"/>
                                        <field name="license_plate"/>
                                        <field name="model_id"/>
                                        <field name="vin_sn"/>
                                        <field name="car_year"/>
                                        <field name="fuel_type"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Time Tracking">
                                <field name="timer_line_ids" nolabel="1" readonly="1">
                                    <list editable="bottom">
                                        <field name="action"/>
                                        <field name="reason"/>
                                        <field name="action_time"/>
                                        <!--                                        <field name="duration" widget="float_time"/>-->
                                    </list>
                                </field>
                            </page>
<!--                            Add Invisible Attribute-->
                            <page name="images_before" string="Before Installation Images" invisible="1"> Add Invisible Attribute
                                <field name="repair_image_line_ids">
                                    <list>
                                        <field name="b_image1" widget="image" class="oe_avatar oe_small"/>
                                        <field name="b_image2" widget="image" class="oe_avatar oe_small"/>
                                        <field name="b_image3" widget="image" class="oe_avatar oe_small"/>
                                        <field name="b_image4" widget="image" class="oe_avatar oe_small"/>
                                        <field name="b_image5" widget="image" class="oe_avatar oe_small"/>
                                    </list>
                                    <form>
                                        <notebook>
                                            <page string="Image1 Before">
                                                <field name="b_image1" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image2 Before">
                                                <field name="b_image2" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image3 Before">
                                                <field name="b_image3" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image4 Before">
                                                <field name="b_image4" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image5 Before">
                                                <field name="b_image5" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                        </notebook>
                                    </form>
                                </field>
                            </page>
<!--                            Add Invisible Attribute-->
                            <page name="images_after" string="After Installation Images" invisible="1">
                                <field name="repair_image_line_ids">
                                    <list>
                                        <field name="a_image1" widget="image" class="oe_avatar oe_small"/>
                                        <field name="a_image2" widget="image" class="oe_avatar oe_small"/>
                                        <field name="a_image3" widget="image" class="oe_avatar oe_small"/>
                                        <field name="a_image4" widget="image" class="oe_avatar oe_small"/>
                                        <field name="a_image5" widget="image" class="oe_avatar oe_small"/>
                                    </list>
                                    <form>
                                        <notebook>
                                            <page string="Image1 After">
                                                <field name="a_image1" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image2 After">
                                                <field name="a_image2" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image3 After">
                                                <field name="a_image3" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image4 After">
                                                <field name="a_image4" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                            <page string="Image5 After">
                                                <field name="a_image5" widget="capture_image"
                                                       class="oe_avatar oe_small"/>
                                            </page>
                                        </notebook>
                                    </form>
                                </field>
                            </page>
                            <page name="work_permit" string="Work Permit">
                            </page>
                            <page name="checklist" string="Checklist">
                                <group>
                                    <field name="order_checklist_ids" options="{'no_create': True}" nolabel="1"
                                           colspan="2">
                                        <list editable="bottom">
                                            <field name="name"/>
                                            <field name="description"/>
                                            <field name="done"/>
                                        </list>
                                    </field>
                                </group>
                                <button name="select_all" string="Select All" type="object" class="oe_highlight"/>
                            </page>

                            <page name="comments" string="Comments">
                                <group>
                                    <field name="notes"/>
                                </group>
                            </page>
                            <!--                            <page string="Timesheet">-->
                            <!--					            <field name="timesheet_ids" widget="one2many_list" >-->
                            <!--					            	<list string="Timesheet" editable="bottom">-->
                            <!--										<field name="workorder_id" column_invisible = "1"/>-->
                            <!--					            		<field name="date"/>-->
                            <!--										<field name="project_id" string="Service Name"/>-->
                            <!--					            		<field name="name"/>-->
                            <!--										<field name="service_type" required="1"/>-->
                            <!--									    <field name="unit_amount" string="Duration (Hours)" widget="timesheet_uom" sum="Total"/>-->
                            <!--									    <field name="company_id" column_invisible = "1"/>-->
                            <!--									    <field name="currency_id" column_invisible = "1"/>-->
                            <!--										<field name="account_id" required="False" column_invisible = "1"/>-->
                            <!--					            	</list>-->
                            <!--								</field>-->
                            <!--					        </page>-->
                        </notebook>
                    </sheet>
                    <chatter/>
                </form>
            </field>
        </record>

        <!--fleet Repair Tree View-->

        <record id="view_fleet_workorder_tree" model="ir.ui.view">
            <field name="name">fleet.workorder.list</field>
            <field name="model">fleet.workorder</field>
            <field name="priority">4</field>
            <field name="arch" type="xml">
                <list string="Work Orders">
                    <field name="name" string="Work Order"/>
                    <field name="phone"/>
                    <field name="user_id"/>
                </list>
            </field>
        </record>


        <record id="view_fleet_workorder_filter" model="ir.ui.view">
            <field name="name">fleet.workorder.list.select</field>
            <field name="model">fleet.workorder</field>
            <field name="arch" type="xml">
                <search string="Search fleet WorkOrder">
                    <field name="sequence"/>
                    <field name="name" string="WorkOrder"/>
                    <field name="fleet_repair_id"/>
                    <separator/>
                </search>
            </field>
        </record>

        <!--Action-->

        <record model="ir.actions.act_window" id="action_fleet_workorder_tree_view">
            <field name="name">Work Orders</field>
            <field name="res_model">fleet.workorder</field>

            <field name="view_mode">list,form</field>
            <field name="search_view_id" ref="view_fleet_workorder_filter"/>
            <field name="view_id" ref="view_fleet_workorder_tree"/>
        </record>

        <!--Menuitems-->

        <menuitem name="Work Orders" parent="menu_sub_car_repair" id="menu_fleet_workorder_submenu" sequence="10"
                  action="action_fleet_workorder_tree_view"/>
    </data>
</odoo>
